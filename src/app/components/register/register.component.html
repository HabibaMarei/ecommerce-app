<section class="bg-main-light shadow p-5 my-3">
    <h1 class="h2 text-main">Register Now:</h1>
    <form [formGroup]="registerForm" (ngSubmit)="registerSubmit()">

        <div class="mb-3 w-100">
            <label for="name" class="form-label">Name:</label>
            <input type="text" class="form-control" id="name" placeholder="Please enter your name" formControlName="name" 
            [ngClass]="{
                'is-valid': registerForm.get('name')?.valid && (registerForm.get('name')?.touched || registerForm.get('name')?.dirty),
                'is-invalid': registerForm.get('name')?.invalid && (registerForm.get('name')?.touched || registerForm.get('name')?.dirty)
            }"            
            />
            @if(registerForm.get('name')?.errors &&( registerForm.get('name')?.touched || registerForm.get('name')?.dirty)){
                <div class="alert alert-danger my-2">
                    @if(registerForm.get('name')?.getError('required')){
                        <p class="p-0 m-0">Name field can't be empty</p>
                    } 
                    @else if (registerForm.get('name')?.getError('minlength')) {
                        <p class="p-0 m-0">Name minimum character length is 3</p>
                    }
                    @else if (registerForm.get('name')?.getError('maxlength')) {
                        <p class="p-0 m-0">Name maximum character length is 20</p>
                    }
                </div>
            }
        </div>

        <div class="mb-3 w-100">
            <label for="email" class="form-label">Email address:</label>
            <input type="email" class="form-control" id="email" placeholder="Please enter a valid email" formControlName="email"
            [ngClass]="{
                'is-valid': registerForm.get('email')?.valid && (registerForm.get('email')?.touched || registerForm.get('email')?.dirty),
                'is-invalid': registerForm.get('email')?.invalid && (registerForm.get('email')?.touched || registerForm.get('email')?.dirty)
            }"   />
            @if(registerForm.get('email')?.errors && registerForm.get('email')?.touched){
                <div class="alert alert-danger my-2">
                    @if(registerForm.get('email')?.getError('required')){
                        <p class="p-0 m-0">Email field can't be empty</p>
                    } 
                    @else if (registerForm.get('email')?.getError('email')) {
                        <p class="p-0 m-0">Please enter valid email address</p>
                    }
                </div>
            }
        </div>

        <div class="mb-3 w-100">
            <label for="phone" class="form-label">Phone:</label>
            <input type="tel" class="form-control" id="phone" placeholder="Please enter a valid phone number" formControlName="phone"
            [ngClass]="{
                'is-valid': registerForm.get('phone')?.valid && (registerForm.get('phone')?.touched || registerForm.get('phone')?.dirty),
                'is-invalid': registerForm.get('phone')?.invalid && (registerForm.get('phone')?.touched || registerForm.get('phone')?.dirty)
            }"   />
            @if(registerForm.get('phone')?.errors && registerForm.get('phone')?.touched){
                <div class="alert alert-danger my-2">
                    @if(registerForm.get('phone')?.getError('required')){
                        <p class="p-0 m-0">Phone field can't be empty</p>
                    } 
                    @else if (registerForm.get('phone')?.getError('pattern')) {
                        <p class="p-0 m-0">Please enter valid phone number</p>
                    }
                </div>
            }
        </div>

        <div class="mb-3 w-100">
            <label for="password" class="form-label">Password:</label>
            <input type="password" class="form-control" id="password" placeholder="Please enter a valid password" formControlName="password"
            [ngClass]="{
                'is-valid': registerForm.get('password')?.valid && (registerForm.get('password')?.touched || registerForm.get('password')?.dirty),
                'is-invalid': registerForm.get('password')?.invalid && (registerForm.get('password')?.touched || registerForm.get('password')?.dirty)
            }"   />
            @if(registerForm.get('password')?.errors && registerForm.get('password')?.touched){
                <div class="alert alert-danger my-2">
                    @if(registerForm.get('password')?.getError('required')){
                        <p class="p-0 m-0">Password field can't be empty</p>
                    } 
                    @else if (registerForm.get('password')?.getError('pattern')) {
                        <p class="p-0 m-0">Please enter valid password</p>
                    }
                </div>
            }
        </div>

        <div class="mb-3 w-100">
            <label for="rePassword" class="form-label">Confirm Password:</label>
            <input type="password" class="form-control" id="rePassword" placeholder="Please enter confirmation password" formControlName="rePassword"
            [ngClass]="{
                'is-valid': !registerForm.getError('mismatch') && (registerForm.get('rePassword')?.touched || registerForm.get('rePassword')?.dirty),
                'is-invalid': registerForm.getError('mismatch') && (registerForm.get('rePassword')?.touched || registerForm.get('rePassword')?.dirty)
            }"   />
            @if(registerForm.getError('mismatch') && registerForm.get('rePassword')?.touched){
                <div class="alert alert-danger my-2">
                    <p class="m-0 p-0">Passwords don't match</p>
                </div>
            }
        </div>

        <button class="btn btn-main" >@if (isLoading) {<i class="fas fa-spin fa-spinner"></i>} Register</button>

        @if(msgError){
            <p class="alert alert-danger my-2">{{msgError}}</p>
        }

    </form>

</section>